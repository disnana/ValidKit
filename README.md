# ValidKit

[![CI](https://github.com/disnana/ValidKit/actions/workflows/ci.yml/badge.svg)](https://github.com/disnana/ValidKit/actions/workflows/ci.yml)
[![PyPI](https://img.shields.io/pypi/v/validkit-py?label=PyPI)](https://pypi.org/project/validkit-py/)
[![License: MIT](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

ValidKit ã¯ã€<strong>ã€Œç›´æ„Ÿçš„ãªã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã€ã¨ã€Œæ—¥æœ¬èªã‚­ãƒ¼ã¸ã®å®Œå…¨å¯¾å¿œã€</strong>ã‚’ç‰¹å¾´ã¨ã™ã‚‹ã€Python ç”¨ã®è»½é‡ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

è¤‡é›‘ã«ãƒã‚¹ãƒˆã•ã‚ŒãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã€Discord ãƒœãƒƒãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã€å¤–éƒ¨ API ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãªã©ã‚’ã€ã‚·ãƒ³ãƒ—ãƒ«ã‹ã¤å …ç‰¢ã«æ¤œè¨¼ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¾ã—ãŸã€‚Pydantic ã»ã©é‡åšã§ã¯ãªãã€ã—ã‹ã—è¾æ›¸ãƒ™ãƒ¼ã‚¹ã®æŸ”è»Ÿæ€§ã¨å¼·åŠ›ãªãƒã‚§ãƒ¼ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚

---

## ğŸš€ ãªãœ ValidKit ãªã®ã‹ï¼Ÿ

- **ã‚¯ãƒ©ã‚¹å®šç¾©ä¸è¦**: è¾æ›¸ãã®ã‚‚ã®ãŒã‚¹ã‚­ãƒ¼ãƒã«ãªã‚Šã¾ã™ã€‚æ—¢å­˜ã® JSON/YAML æ§‹é€ ã‚’ãã®ã¾ã¾å®šç¾©ã«è½ã¨ã—è¾¼ã‚ã¾ã™ã€‚
- **æ—¥æœ¬èªã‚­ãƒ¼ã«ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼**: `v.str()` ã‚„ `v.int()` ã‚’æ—¥æœ¬èªã®ã‚­ãƒ¼åã¨çµ„ã¿åˆã‚ã›ã¦ã€å¯èª­æ€§ã®é«˜ã„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨˜è¿°ã§ãã¾ã™ã€‚
- **é«˜åº¦ãªæ¤œè¨¼ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«**: æ­£è¦è¡¨ç¾ã€æ•°å€¤ç¯„å›²ã€ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ã€ã•ã‚‰ã«ã¯ã€Œä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã«å¿œã˜ãŸæ¤œè¨¼ï¼ˆæ¡ä»¶ä»˜ãæ¤œè¨¼ï¼‰ã€ã‚‚ç›´æ„Ÿçš„ã«æ›¸ã‘ã¾ã™ã€‚
- **ãƒ¢ãƒ€ãƒ³ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼**: SLSA v3 æº–æ‹ ã®æ¥æ­´è¨¼æ˜ï¼ˆprovenanceï¼‰ã«å¯¾å¿œã—ã€ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³ã®å®‰å…¨æ€§ã‚’ç¢ºä¿ã—ã¦ã„ã¾ã™ã€‚

---

## ç›®æ¬¡

* [æ¦‚è¦](#æ¦‚è¦)
* [ç‰¹å¾´](#ç‰¹å¾´)
* [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
* [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)
* [API ä¾‹](#api-ä¾‹)
* [é«˜åº¦ãªä½¿ã„æ–¹](#é«˜åº¦ãªä½¿ã„æ–¹)
* [å“è³ªç®¡ç†ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#å“è³ªç®¡ç†ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
* [è²¢çŒ®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](#è²¢çŒ®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)
* [ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](#ãƒ©ã‚¤ã‚»ãƒ³ã‚¹)

---

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install validkit-py
```

---

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

ã‚ãšã‹æ•°è¡Œã§ã€è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚

```python
from validkit import v, validate, ValidationError

# ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ï¼šè¾æ›¸ã®å½¢ãŒãã®ã¾ã¾ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ§‹é€ ã«ãªã‚Šã¾ã™
SCHEMA = {
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼å": v.str().regex(r"^\w{3,15}$"),
    "ãƒ¬ãƒ™ãƒ«": v.int().range(1, 100),
    "ã‚¹ã‚­ãƒ«": v.list(v.oneof(["ç«", "æ°´", "é¢¨"])),
    "è¨­å®š": {
        "é€šçŸ¥": v.bool(),
        "è¨€èª": v.oneof(["æ—¥æœ¬èª", "English"]).optional()
    }
}

data = {
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼å": "nana_kit",
    "ãƒ¬ãƒ™ãƒ«": 50,
    "ã‚¹ã‚­ãƒ«": ["ç«", "é¢¨"],
    "è¨­å®š": {"é€šçŸ¥": True}  # è¨€èªã¯ optional ãªã®ã§çœç•¥å¯èƒ½
}

try:
    # æ¤œè¨¼å®Ÿè¡Œ
    validated = validate(data, SCHEMA)
    print(f"æ¤œè¨¼æˆåŠŸï¼ãƒ¬ãƒ™ãƒ«: {validated['ãƒ¬ãƒ™ãƒ«']}")
except ValidationError as e:
    # ã©ã“ã§ä½•ãŒã‚¨ãƒ©ãƒ¼ã«ãªã£ãŸã‹ã€åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ‘ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
    print(f"ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç®‡æ‰€: {e.path} - {e.message}")
```

---

## ç‰¹å¾´

* ğŸ“ **ç›´æ„Ÿçš„ãªãƒã‚§ã‚¤ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰** â€” `v.int().range(1, 10).optional()` ã®ã‚ˆã†ã«æµã‚Œã‚‹ã‚ˆã†ã«è¨˜è¿°ã€‚
* ğŸŒ **æ—¥æœ¬èªã‚­ãƒ¼å¯¾å¿œ** â€” æ—¥æœ¬èªã®ã‚­ãƒ¼åã‚’ãã®ã¾ã¾æ‰±ãˆã‚‹ãŸã‚ã€ä»•æ§˜æ›¸ã«è¿‘ã„ã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã¾ã™ã€‚
* ğŸ”„ **å¼·åŠ›ãªå¤‰æ›ãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** â€” æ—§å½¢å¼ã‹ã‚‰æ–°å½¢å¼ã¸ã®ã‚­ãƒ¼åå¤‰æ›ã‚„ã€å€¤ã®å‹•çš„å¤‰æ›ã‚’æ¤œè¨¼æ™‚ã«åŒæ™‚ã«è¡Œãˆã¾ã™ã€‚
* ğŸ› ï¸ **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ãƒãƒ¼ã‚¸** â€” ä¸è¶³ã—ã¦ã„ã‚‹å€¤ã‚’ãƒ™ãƒ¼ã‚¹è¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼‰ã§è‡ªå‹•è£œå®Œã—ã¾ã™ã€‚
* ğŸ” **å…¨ã‚¨ãƒ©ãƒ¼ã®ä¸€æ‹¬åé›†** â€” æœ€åˆã®ã‚¨ãƒ©ãƒ¼ã§æ­¢ã¾ã‚‰ãšã€ã™ã¹ã¦ã®ä¸å‚™ã‚’æ´—ã„å‡ºã™ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

---

## API ä¾‹

è©³ç´°ãªãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯ [docs/index.md](docs/index.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### åŸºæœ¬ãƒãƒªãƒ‡ãƒ¼ã‚¿
* `v.str()`: æ–‡å­—åˆ—
* `v.int()` / `v.float()`: æ•°å€¤
* `v.bool()`: çœŸå½å€¤
* `v.list(schema)`: ãƒªã‚¹ãƒˆï¼ˆè¦ç´ ã®ã‚¹ã‚­ãƒ¼ãƒã‚’æŒ‡å®šï¼‰
* `v.dict(key_type, value_schema)`: è¾æ›¸

### ä¿®é£¾ãƒ¡ã‚½ãƒƒãƒ‰
* `.optional()`: å¿…é ˆã§ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã™ã‚‹
* `.default(value)`: å€¤ãŒãªã„å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æŒ‡å®šï¼ˆâ€»å®Ÿè£…äºˆå®š/ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸æ¨å¥¨ï¼‰
* `.regex(pattern)`: æ­£è¦è¡¨ç¾ãƒã‚§ãƒƒã‚¯
* `.range(min, max)` / `.min(val)` / `.max(val)`: ç¯„å›²ãƒã‚§ãƒƒã‚¯
* `.custom(func)`: ç‹¬è‡ªã®å¤‰æ›ãƒ»æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ³¨å…¥

---

## é«˜åº¦ãªä½¿ã„æ–¹

### éƒ¨åˆ†æ›´æ–°ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ãƒãƒ¼ã‚¸

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€éƒ¨ã ã‘ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤‰æ›´ã—ãŸå ´åˆãªã©ã«ä¾¿åˆ©ã§ã™ã€‚

```python
DEFAULT_CONFIG = {"è¨€èª": "English", "éŸ³é‡": 50}
user_input = {"éŸ³é‡": 80}

# partial=True ã§ä¸è¶³ã‚­ãƒ¼ã‚’è¨±å®¹ã—ã€base ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è£œå®Œ
updated = validate(user_input, SCHEMA, partial=True, base=DEFAULT_CONFIG)
# -> {'è¨€èª': 'English', 'éŸ³é‡': 80}
```

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«æ–°ã—ã„å½¢å¼ã¸å¤‰æ›ã—ã¾ã™ã€‚

```python
old_data = {"æ—§è¨­å®š": "on", "timeout": 30}

migrated = validate(
    old_data, 
    SCHEMA, 
    migrate={
        "æ—§è¨­å®š": "é€šçŸ¥",
        "timeout": lambda v: f"{v}s"
    }
)
```

---

## å“è³ªç®¡ç†ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **in-toto / SLSA v3 æº–æ‹ ã® provenanceï¼ˆæ¥æ­´è¨¼æ˜ï¼‰** ã‚’å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚
PyPI ã«å…¬é–‹ã•ã‚ŒãŸæˆæœç‰©ãŒã€æ­£ã—ã„ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æ­£ã—ã„æ‰‹é †ã§ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸã“ã¨ã‚’æ•°å­¦çš„ã«è¨¼æ˜ã§ãã¾ã™ã€‚

```bash
# slsa-verifier ã‚’ä½¿ã£ãŸæ¤œè¨¼ä¾‹
slsa-verifier verify-artifact dist/validkit-*.whl \
  --provenance multiple.intoto.jsonl \
  --source-uri github.com/disnana/ValidKit
```

### é–‹ç™ºå“è³ª
ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ CI ã§å¸¸æ™‚å®Ÿè¡Œã—ã€é«˜ã„ã‚³ãƒ¼ãƒ‰å“è³ªã‚’ç¶­æŒã—ã¦ã„ã¾ã™ã€‚
* **Ruff**: é«˜é€Ÿãª Lint & ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
* **mypy**: å³æ ¼ãªé™çš„å‹ãƒã‚§ãƒƒã‚¯
* **pytest**: ç¶²ç¾…çš„ãªå˜ä½“ãƒ†ã‚¹ãƒˆ

---

## è²¢çŒ®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

Issue ã®å ±å‘Šã‚„ Pull Request ã‚’æ­“è¿ã—ã¾ã™ï¼è©³ç´°ã¯ [SECURITY.md](SECURITY.md) ã¾ãŸã¯ Issue ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---
**MIT License**
